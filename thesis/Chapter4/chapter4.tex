\section{How to improve security for Identity federations}
\section{How to combine Identity federations and DANE}
As stated earlier it's possible to divide federations into two categories, those with a federation provider and those without.
In the analysis that has been done the solution with a federation provider is the most probable and viable setup in the long run, it's basiclly much easier to scale, both technically and non-technically.
It's with this configuration in mind the following evaluation has been made.

%TODO: (1) Kontrollera att det finns information om b책da kategorierna av federationer.
%TODO: (2) Kontrollera att analys 채r gjord och att det verkligen 채r varianten med en FO som 채r mest trolig.

With a federation provider publishing all the metadata about all service providers, identity providers and other entities how do the trusting entites rely on the federation provider?
Is it the correct federation provider the trusting entities connect to or is it someone trying to "impersonate" the role of the federation provider as a man-in-the-middle attack.

As of now the trust must be made in some out-of-band way e.g. a simple download of the federation provider's certificate and then confirm it's the correct one via telephone or email communcation between administrators.
This is not very practical when the federation grows bigger with tenths or hundreds of service providers and identity providers.

\subsection{SAML2 certificate as a TLSA resource record}
The first solution that comes into mind is that it might be possible to publish the federation provider's certificate as a TLSA RR.
This would mean that when a requesting entity (service provider, identity provider or any other entity) needs to update the metadata about all other entities it connects to the federation provider and downloads the metadata.
At the same time the requesting entity sends out a DNS lookup for a corresponding TLSA RR.
When both the metadata and the TLSA RR is retrieved, a comparison can be made and confirm or dismiss the validity of the metadata.

A problem that still exists with this approach is how will the metadata about each entity be transmitted to the federation provider and validated by the federation provider.
To keep building on the same solution each entity would have to publish respective certificate as a TLSA RR themselves in their own domain zone.
Now the initial upload of metadata from an entity to the federation provider could be intitated, perhaps through a web interface with or witout some PGP solution.
The federation provider than fetches the metadata aswell as the corresponding TLSA RR from the entity and if it's the correct signature on it the federation provider than put its signature on it and publish it with the metadata from all other entities.
Within one cache interval all entities will now fetch a complete updated metadata file/list from the federation provider.

% TODO: What is a cache interval?
% TODO: What is a domain zone?

This would require a new internet standard and allocation of a new "certificate usage" number to make this work properly.
New questions arises here, is the need really that big to come together for a new standard to support a fully functional federation?
The second question that comes to mind is more technical.
If TLSA RRs or any other DNS RR type that requires DNSSEC is required, is it not possible to just use the TLSA RR with TLS certificates as it is and not introduce new "certificate usage"?

\subsection{Only use TLSA RR with TLS}
Let's start with the second question and get back to the first one later on.


% \cite[p.~256]{pdf:SOU}

%\section{Temporary section}
%EVALUATION This is where you put the spotlight on your solution's strengths and
%weaknesses. An evaluation must be made of the methods/theory applied and the validity
%and reliability of the data. You should describe the most interesting results of your work in a
%results section. Remember that less important but complementary results can to advantage
%be placed in appendices. A rule of thumb is that all results that you use in your analysis and
%in your conclusions should be reported in the Evaluation chapter and the rest reported in
%appendices.

